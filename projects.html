<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Projects">
    <link rel="stylesheet" href="styles/styles.css">
    <title>Projects</title>
    <style>
      border-tag {
        display: inline-block;
        border: 2px solid black;
        padding: 4px;
        margin: 4px;
      }
    </style>
</head>
<body style="background-color:#ffdeb5;">
    <header style="background-color:#FFD580;">
        <h1>Projects</h1>

        <ul>
            <li><button id="light" on="true" onclick="lightMode()">‚òÄÔ∏è</button></li>
            <li><button id="dark" on="false" onclick="darkMode()">üåô</button></li>
        </ul>
        <noscript>
            <style>
                #light, #dark {
                    display: none;
                }
            </style>
        </noscript>
        
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="projects.html" style="background-color:#FFAC1C;border-radius:0%;">Projects</a></li>
                <li><a href="resume.html">Resume</a></li>
                <li><a href="experiments.html">Experiments</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <div class="cards-container"></div>
    </main>
    <div></div>
    <footer>
        <p>&copy; 2025 Clarence Chow. All Rights Reserved.</p>
    </footer>

    <script>
        /* Light and Dark Mode */
        let mode = "light";
        if(localStorage.getItem("mode") == "dark")
            darkMode();
        else
            localStorage.setItem("mode", "light");

        function lightMode() {
            if(mode == "light")
                return;

            console.log("go light mode now");
            const body = document.getElementsByTagName("body").item(0);
            const lightButton = document.getElementById("light");
            const darkButton = document.getElementById("dark");

            body.style.color = "black";
            body.style.backgroundColor = "#ffdeb5";

            lightButton.setAttribute("on", "true");
            darkButton.setAttribute("on", "false");
            
            mode = "light";
            localStorage.setItem("mode", "light");
        }

        function darkMode() {
            if(mode == "dark")
                return;

            console.log("go dark mode now");
            const body = document.getElementsByTagName("body").item(0);
            const lightButton = document.getElementById("light");
            const darkButton = document.getElementById("dark");

            body.style.color = "white";
            body.style.backgroundColor = "#805100";

            lightButton.setAttribute("on", "false");
            darkButton.setAttribute("on", "true");

            mode = "dark";
            localStorage.setItem("mode", "dark");
        }

        /* Custom Elements HW5 */

        fetch('projects.json')
        .then(response => response.json())
        .then(data => {
            localStorage.setItem('projects', JSON.stringify(data));
            generateProjectCards(data); })
        .catch(error => console.error('Error fetching projects:', error));

        class ProjectCard extends HTMLElement {
            constructor() {
                super();
                this.innerHTML = `
                    <article>
                        <h2>${this.getAttribute('title')}</h2>
                        <picture>
                            <img src="${this.getAttribute('image')}" alt="${this.getAttribute('alt')}">
                        </picture>
                        <p>${this.getAttribute('description')}</p>
                        <a href="${this.getAttribute('link')}">Learn more</a>
                    </article>
                `;
            }
        }
        customElements.define('project-card', ProjectCard);

        /*function loadProjects() {
            const container = document.querySelector('.cards-container');

            const localProjects = JSON.parse(localStorage.getItem('projects') || '[]');
            localProjects.forEach(project => createProjectCard(project, container));

            fetch('projects.json')
                .then(response => response.json())
                .then(data => {
                    data.forEach(project => createProjectCard(project, container));
                });
        }*/

        window.onload = function() {
            const storedProjects = localStorage.getItem('projects');
            const container = document.querySelector('.cards-container');
            
            if (storedProjects) {
                projects.forEach(project => {
                    createProjectCard(project, container)
                });
            }
        };

        function createProjectCard(data, container) {
            const card = document.createElement('project-card');
            card.setAttribute('title', data.title);
            card.setAttribute('image', data.image);
            card.setAttribute('alt', data.alt);
            card.setAttribute('description', data.description);
            card.setAttribute('link', data.link);
            container.appendChild(card);
        }

        //document.addEventListener('DOMContentLoaded', loadProjects);
    </script>
</body>
</html>
